!function e(r,t,i){function o(a,s){if(!t[a]){if(!r[a]){var d="function"==typeof require&&require;if(!s&&d)return d(a,!0);if(n)return n(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=t[a]={exports:{}};r[a][0].call(l.exports,function(e){var t=r[a][1][e];return o(t?t:e)},l,l.exports,e,r,t,i)}return t[a].exports}for(var n="function"==typeof require&&require,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(e,r,t){!function(e){e(function(){var r={prizes:[],itemWidth:0,spaceBetween:.2,slidesOffsetBefore:.2,slidesOffsetAfter:.2,showLucky:!1},t=function(t,i){i=e.extend({},r,i);var o=0,n=e('<div id="prizes-wrapper"></div>');i.prizes.forEach(function(e,r){if(!e.hidden||"lucky"===e.prizeType&&i.showLucky){var t='<div class="prize-item" style="display: inline-block; margin-right: '+i.spaceBetween+'rem;" data-id="'+e.id+'" data-type="'+e.prizeType+'">';t+='<div class="prize-img-box"><img class="prize-img" src="'+e.image+'" /></div><p class="prize-name">'+e.title+"</p></div>",n.append(t),o++}});var a=o*(i.itemWidth+i.spaceBetween)+i.slidesOffsetAfter+i.slidesOffsetBefore;n.css({width:a+"rem","padding-left":i.slidesOffsetBefore+"rem","padding-right":i.slidesOffsetAfter+"rem"}),e(t).html(n).append('<div class="prize-tag"></div>'),e("#prizes-wrapper").attr("data-length",o)};window.prizesRender=t})}(Zepto)},{}],2:[function(e,r,t){!function(r){e("../../components/prizesRender"),r(function(){FastClick(document.body);var e="//yun.duiba.com.cn/h5-tuia/couponPrize/1.5/index_201705161844.js",t="//yun.duiba.com.cn/h5-tuia/couponPrize/1.5/index_201705161844.css",i="//yun.duiba.com.cn/h5-tuia/couponPrize/1.5.2/index_201705161844.js",o="//yun.duiba.com.cn/h5-tuia/couponPrize/1.5.2/index_201705161844.css",n={_UA:navigator.userAgent.toLowerCase(),lastResult:null,running:!1,options:null,init:function(){var n=this;this._UA.match(/iphone|ipad/gi)?r(".apple").show():r(".apple").hide(),Promise.all([this.getStyle(),this.getOption()]).then(function(){n.preEvents(),loader(function(){n.hasNoTimes&&n.showModal("over"),n.events(),new IScroll("#prize-list",{scrollX:!0,scrollY:!1,mouseWheel:!1,scrollbars:!0,shrinkScrollbars:"clip",fadeScrollbars:!1}),initCouponPrize({oldJS:e,oldCSS:t,newJS:i,newCSS:o})})})},getStyle:function(){var e=this;return new Promise(function(t,i){e.getTuiaStyle({success:function(o){if(o.success){var n=[["#db-content","backgroundImage","bgImage"],["body","backgroundColor","bgColor"],[".record","backgroundImage","record"],[".rule-btn","backgroundImage","ruleBtn"],[".apple","backgroundColor","appleBgColor"],[".apple","color","appleTextColor"],[".theme","image","theme"],["#myCredits","color","myCreditsColor"],["#needCredits","color","myCreditsColor"],[".rule-modal .rule-modal-dialog section .probability .nav","backgroundColor","probabilityBgColor"],[".card","backgroundImage","card"],[".card.light","backgroundImage","cardActive"],[".dealer","image","dealer"]];requireStyle.init(o,n),window.isNew=o.data.isNew,setTimeout(function(){var e=new Image;e.src=requireStyle.getStyle("cardActive")},10),r("#db-content").show();var a=new Image;a.src=requireStyle.getStyle("card"),a.onload=function(){setTimeout(function(){e.dealCards()},500)},t()}else e.showModal("systemError",{message:o.desc}),i()},error:function(){e.showModal("networkError"),i()}})})},getOption:function(){var e=this;return new Promise(function(t,i){e.getTuiaOptions({success:function(i){if(i.success){var o=i.data,n=o.options.length,a=["zero","one","two","three","four","five","six"][n];e.renderElement(o),r(".card-wrapper").addClass(a);for(var s=0;s<n;s++)r(".card-wrapper").append('<div class="card init"></div>');e.options=o.options,window.prizesRender("#prize-list",{prizes:o.options,itemWidth:.7,spaceBetween:.05,slidesOffsetBefore:.15,slidesOffsetAfter:0}),t()}}})})},events:function(){var e=this;new RuleModal({modal:!1,trigger:".rule"}),r("#prize-list").on("click",".prize-item",function(){new GetPrizeDetail({url:CFG.getPrizeDetail,prizeType:r(this).data("type"),data:{optionId:r(this).data("id")}})}),r("body").on("click",".recommend-modal .close",function(){e.reInit()})},preEvents:function(){var e=this;r(".card-wrapper").on("click",".card",function(){e.gameStart(r(this))})},dealCards:function(){function e(){o<i.length?(i.eq(o).removeClass("init"),o++,setTimeout(e,300)):(t.running=!1,t.cardLight())}var t=this;if(!this.options)return void setTimeout(function(){t.dealCards()},1e3);var i=r(".card"),o=0;this.running=!0,e()},cardLight:function(){function e(){t.running||(r(".card").removeClass("light").eq(i).addClass("light"),i++,i=i>=o?0:i,setTimeout(e,600))}var t=this,i=0,o=r(".card").length;e()},gameStart:function(e){return!this.running&&(this.running=!0,r(".card").removeClass("light"),e.addClass("active"),r(".card-cover").show(),e.addClass("shake"),void this.getOrder())},gameOver:function(e){var t=this;buoyInit(t.isShowBuoy),r(".card.active").removeClass("shake").addClass("turn"),this.running=!1,setTimeout(function(){switch(e.data.result){case 0:t.showModal("noPrize");break;case 1:t.showModal("again");break;case 2:var i=e.data.lottery;"coupon"==i.type||"lucky"==i.type?window.showCouponPrize({result:e.data,callback:{close:function(){t.hideModal()},use:function(){r(".J_modalShowPrize").remove(),t.hideModal()}}}):window.showObjectPrize({name:i.title,type:i.type,img:i.imgurl,onsubmit:function(){window.location.href=i.link},onclose:function(){t.hideModal()}}),setTimeout(function(){t.gameReset()},100)}},400)},getOrder:function(){var e=this,r={};this.againOrderId&&(r.againOrderId=this.againOrderId),this.getTuiaOrder({data:r,success:function(r){var t=e.getTuiaErrorCode(r.code);"success"==t?(e.againOrderId=null,e.renderElement(r.data),e.isShowBuoy=r.data.isShowBuoy,setTimeout(function(){e.getLottery(r.data.orderId)},500)):"networkError"==t?e.showModal("networkError"):"over"==t?e.showModal("over"):"preview"==t&&e.showModal("preview")},error:function(r,t){"timeout"==t?(window.xhr&&window.xhr.abort(),e.showModal("systemError",{message:"请求超时"})):e.showModal("networkError")}})},getLottery:function(e){var r=this;this.getTuiaLottery({data:{orderId:e,showVersion:!!window.isNew},success:function(t){var i=r.getTuiaErrorCode(t.code);"success"==i?"wait"==t.data.status?setTimeout(function(){r.getLottery(e)},1e3):"success"==t.data.status&&r.gameOver(t):"networkError"==i?r.showModal("networkError"):r.showModal("noPrize")},error:function(e,t){"timeout"==t?(window.xhr&&window.xhr.abort(),r.showModal("systemError",{message:"请求超时"})):r.showModal("networkError")}})},gameReset:function(){r(".card").removeClass("active shake turn"),r(".card-cover").hide(),r(".card").addClass("init")},showModal:function(e,r){var t=this,i=this.createErrorObject(e,r);"over"===i.type?window.recommendModal.show():(i.clickCallback=function(){t.hideModal()},window.errorMsgModal.show(i)),t.gameReset()},hideModal:function(){this.reInit(),this.hasNoTimes&&this.showModal("over")},reInit:function(){this.dealCards()},renderElement:function(e){r("#needCredits").html(this.getTuiaStatusText(e)).show(),e.limitTimes||CFG.preview?this.hasNoTimes=!1:this.hasNoTimes=!0}};n=r.extend({},n,Public),n.init()})}(Zepto)},{"../../components/prizesRender":1}]},{},[2]);